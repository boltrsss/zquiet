import{i as b,a as e,lP as re,E as R,aC as oe,D as U,G as L,d$ as de,f9 as ue,dl as Z,q3 as j,K as S,al as G,aX as g,ed as Q,a0 as ae,qi as X,cl as pe,h5 as he,bZ as _e,cn as J,an as W,co as se,am as fe,eI as ie,U as B,a7 as C,cq as be,hk as ye,qj as ge,cR as ve,qk as Pe,ql as Ie,qm as Ee,bU as Se,e_ as Ce,lO as Fe,bf as ee,z as Me,d as Re,mr as ke,B as z,aI as ne,as as Oe,gq as we,aj as xe,e as Ne,qn as Te,aZ as Le}from"./app.ZXowmuNl.js";import{u as Ae}from"./ShopPayOptInDisclaimer.DFHycp8H.js";function ze(){const n=b();return e(R,{size:"small",color:"subdued",children:e(re,{children:n("shop_pay_remember_me.terms_and_privacy_html",{privacy_href:e(Ve,{}),terms_href:e(Be,{})},"By continuing, you agree to Shop Pay’s %{privacy_href} and %{terms_href}.")})})}function Be(){const n=b();return e(L,{children:e(oe,{target:"_blank",href:"https://shop.app/terms-of-service",tone:"monochrome",accessibilityLabel:n("shop_pay_remember_me.new_window_disclaimer","(opens a new window)"),children:[n("shop_pay_remember_me.terms_of_service","Terms of Service"),e(U,{type:"external",size:"small",display:"inline"})]})})}function Ve(){const n=b();return e(L,{children:e(oe,{target:"_blank",href:"https://www.shopify.com/legal/privacy/app-users",tone:"monochrome",accessibilityLabel:n("shop_pay_remember_me.new_window_disclaimer","(opens a new window)"),children:[n("shop_pay_remember_me.privacy_policy","Privacy Policy"),e(U,{type:"external",size:"small",display:"inline",appearance:"monochrome"})]})})}function qe({field:n="phone",link:o}){const t=b();return e(L,{children:[e(R,{color:"subdued",children:e(re,{children:[n==="phone"?t("shop_pay_remember_me.description_html","Next time you check out here or on other stores powered by Shopify, you’ll receive a code by text message to securely purchase with Shop Pay."):t("shop_pay_remember_me.email_description_html","Your email will be used to create your Shop account so you can pay faster next time.")," ",o]})}),e(ze,{})]})}const De=de(function({autocomplete:o="email",...t},a){return e(ue,{type:"email",autocomplete:o,...t,ref:a})});function $e({defaultEmail:n}){const{record:o}=Z(),{autoOptIn:t,isOptedIn:a}=j(),[s,r]=S(n),i=G(void 0),c=g(()=>{s!==i.current&&(i.current=s,o({schemaId:"shopify_pay_user_optin_ui_interaction/3.2",payload:{action:"update_email_input",email:s,source:"order_created",trigger:t&&a?"auto":"manual"}}))},[t,a,s,o]);return{value:s,handleInput:u=>{r(u)},handleBlur:()=>{c()}}}function He({value:n,onInput:o,onBlur:t}){const a=b(),{value:s,handleInput:r,handleBlur:i}=$e({defaultEmail:n});return e(De,{id:"email",name:"email",label:a("shop_pay_remember_me.email_label","Email"),value:s,onInput:c=>{r(c),o?.(c)},onBlur:()=>{i(),t?.()},required:!1})}function Je(){const n=Q(void 0),o=Q(void 0),t=b(),a=ae(),[,s]=X(),r=pe(),i=a.shippingAddress.fields.firstName.value,c=he("shipping"),p=!_e(()=>c??r,[c,r]).isRequired("firstName")&&!J(i),h=g(l=>{if(!J(l))return t("field_errors.address_first_name_blank","Enter a first name")},[t]),y=g(l=>{if(!p)return;if(!J(l))return o.value=W.InvalidOptInName,t("field_errors.address_first_name_blank","Enter a first name");const F=n.peek()||"";s({optInFirstName:F})},[p,n,s,t,o]),k=se(n,o,h);return fe(n,o,y,W.InvalidOptInName),p?e(B,{children:e(ie,{name:"shopFirstName",label:t("contact.first_name_label","First name"),required:!0,...k})}):null}function Ue({countryCode:n,validationError:o,value:t,onBlur:a=()=>{},onInput:s=()=>{}}){const r=b(),{record:i}=Z(),c=G(""),u=g(p=>{i({schemaId:"shopify_pay_user_optin_ui_interaction/3.2",payload:{action:"update_phone_input",phoneNumber:c.current,source:"order_created",trigger:p}})},[i]);return C(()=>{c.current!==t&&(c.current=t,u("auto"))},[u,t]),e(be,{error:o?e(R,{children:r("general.errors.buyer_identity.phone_number_does_not_match_expected_pattern","The specified phone number does not match the expected pattern.")}):void 0,countryCode:n,label:r("shop_pay_remember_me.mobile_phone_number","Mobile phone number"),value:t,icon:"mobile",prefillCountryCode:!!n,onInputValueChange:p=>{s?.(p,n),c.current=p},onBlur:()=>{u("manual"),a?.()},onSelectedCountryChange:(p,h)=>{s?.(h,p),c.current=h}})}const T="RememberMeCheckbox";function te(){const{record:n}=Z(),o=ae(),{value:t}=ye(),{autoOptIn:a,isOptedIn:s}=j(),[r,i]=X(),c=r||a&&r===void 0,u=o.phone.value,p=o.email.value,h=!u,{shopPayOptInPhone:y}=t||{},k=ge(),[l,O]=S(k),F=ve(),[f,M]=S([]),A=f.includes(T)||!!r,V=!h,{validate:E,error:q}=Pe(l,A,V),v=Ie(),P=Ee(l),w=G(P),[_,Y]=S(r&&r.vaultPhone||y||P||""),[x,K]=S(r&&r?.vaultEmail||p||""),N=g((d,m)=>{n({schemaId:"shopify_pay_user_optin_ui_interaction/3.2",payload:{action:d,phoneNumber:m.phone,email:m.email,source:"order_created",trigger:a&&s?"auto":"manual"}})},[n,a,s]),D=g(d=>{E(d,l)||F("violationError",{error:{message:"The specified phone number does not match the expected pattern",code:"remember_me_phone_error",field:"phone",origin:"client",type:"inline-validation"},timestamp:new Date})},[l,E,F]),$=g((d,m)=>{O(m),Y(d);const I=v(d,m);i({optInPhone:I??d,optInEmail:""})},[i,v]),le=g(d=>{K(d);const m=v(u,l);i({optInPhone:m??u,optInEmail:d})},[v,u,i,l]),ce=g(d=>{M(d);const m=d.includes(T),I=r&&r.vaultPhone||y||P||_,H=r&&r.vaultEmail||x;Y(I),K(H);const me=v(I,l);i(m?{optInPhone:me??I,optInEmail:h?"":H}:!1),m&&I&&E(I,l),N(m?"click_remember_me_box":"unclick_remember_me_box",{phone:I,email:H})},[l,x,v,E,_,N,i,y,P,r,h]);return C(()=>{if(!f.includes(T)||!a)return;const d=!_||_==="",m=P||y||void 0;d&&m&&m!==w.current?($(m,l),D(m),w.current=m):d||(w.current=m)},[f,_,l,P,y,r,$,a,N,D]),C(()=>{M(c?[T]:[])},[c]),C(()=>{A&&_&&E(_,l)},[]),C(()=>{if(n({schemaId:"shopify_pay_user_optin_ui_impression/1.0",payload:{elementType:"remember_me_box",source:"order_created"}}),a&&s){const d=h?"":x;N("click_remember_me_box",{phone:_,email:x}),i({optInPhone:_,optInEmail:d})}},[a,n,N]),e(Ce,{name:"RememberMe",value:f,variant:"group",onChange:ce,children:e(Se,{id:T,details:e(B,{children:[e(Je,{}),h?e(Ue,{countryCode:l,validationError:q,value:_,onInput:$,onBlur:()=>D(_)}):e(He,{value:x,onInput:le}),s?null:e(L,{children:e(qe,{field:h?"phone":"email",link:null})})]}),children:e(Ze,{})})})}function Ze(){const n=b(),o=Fe(),{autoOptIn:t}=j();return t?e(R,{children:n("shop_pay_remember_me.label_shop_account","Save my information for a faster checkout with a Shop account")}):o?e(R,{children:n("shop_pay_remember_me.payment_information_only_label","Save my payment information for a faster checkout")}):e(R,{children:n("shop_pay_remember_me.label","Save my information for a faster checkout")})}const je={title:"Shop",style:{fill:"var(--x-default-color-icon)",width:44,height:17}};function Ge(){const o=b()("shop_pay_remember_me.secure_label","Secure and encrypted");return e(ee,{columns:["fill","auto"],children:[e(ee,{columns:["auto","fill"],spacing:"small400",blockAlignment:"center",children:[e(U,{size:"small-200",type:"lock"}),e(Me,{color:"subdued",type:"small",children:o})]}),e(Re,{children:e(ke,{...je})})]})}function We({variant:n}){const o=b(),t=Ae(),[a,s]=X();if(C(()=>{!t&&a&&s(!1)},[t,s,a]),!t)return null;if(n==="minimal")return e(L,{children:[e(z,{spacing:"small100"}),e(te,{})]});const r=e(we,{sectionId:"rememberMe",children:e(te,{})});return n==="compact"?e(Oe,{accessibilityLabel:o("shop_pay_remember_me.title","Remember me"),children:e(B,{children:[e(ne,{level:2,children:o("shop_pay_remember_me.title","Remember me")}),r]})}):e(B,{spacing:"none",children:[e(z,{spacing:"small100"}),e(ne,{level:2,children:o("shop_pay_remember_me.title","Remember me")}),e(z,{}),r,e(z,{spacing:"small100"}),e(Ge,{})]})}function en({localizationExtension:n,index:o}){const t=xe(),{negotiate:a}=Ne(),[s,r]=S(),[i,c]=S(),u=se(n.fields.value,t),p=n.fields.title.value,{localizedFieldErrors:h}=Te(),y=`$.cart.localizedField.${n.peek().key}`,k=`$.localizationExtension[${o}]`,l=h.find(({target:f})=>f===y),O=f=>{const M=f.violations?.find(E=>{const{code:q,localizedMessage:v,nonLocalizedMessage:P,target:w}=E,_=v??P;if(q==="LOCALIZATION_EXTENSION_FIELD_ERROR"&&w===k)return _});if(!M)return;const{localizedMessage:A,nonLocalizedMessage:V}=M;return A??V};C(()=>{if(l){t.value=l.message;return}if(i){t.value=i;return}t.value=void 0},[t,l,i,s]);const F=()=>{u.onBlur(),r(void 0),c(void 0),a({fieldsToResolve:["localizationExtensions"],include:["localizationExtensions"],onComplete:f=>{c(O(f)),r("blur")}})};return Le(f=>{c(O(f)),r("submit")}),e(ie,{...u,label:p,name:p,onBlur:F,value:u.value??void 0})}export{De as E,en as L,We as R,qe as a};
