import{i2 as Ue,d4 as fe,d3 as Pe,ap as xe,bk as ve,bl as X,d9 as Re,bZ as R,db as ce,dc as x,i3 as Oe,hy as Be,bn as _e,K as A,aX as M,e1 as Ce,a as _,i4 as Fe,al as I,ci as $e,i5 as He,a7 as g,$ as ye,i6 as We,G as Me,ck as Ge,dj as ze,i7 as qe,b7 as Ie,i8 as we,i9 as be,ia as K,ib as Le,ds as le,ic as Q,id as F,ie as Ae,ig as H,ih as re,ii as he,c3 as J,ij as Ke,ik as ae,il as Te,im as je,d2 as Ye,io as Se,a2 as Qe,ip as Je,fR as Xe,i as Ze,fh as et,iq as tt,ir as nt,is as De,it as ot,iu as st,iv as rt,b0 as at,iw as ke}from"./app.ZXowmuNl.js";import{p as $,S as O,A as q,u as it,M as Ne,a as ct}from"./useSubscribeMessenger.DwS1Pxbm.js";import{u as ut,a as dt,i as lt,b as Y,c as pe,d as Ve,e as me,f as ft,A as ht,g as pt,r as mt,R as yt,h as Ee,j as St,k as kt}from"./index.BZKzUk0m.js";const Et=e=>{const{alternate:n}=_e(),t=Ue(),o=fe(),{iframe_token:s,redirect_url:l,transaction_params:c}=Pe(),r=xe(),{myshopifyDomain:u}=ve(),{checkoutSessionIdentifier:a}=X(),i=Re();return R(()=>{if(!a)throw new ce("ShopPayCheckoutIdentifierMissingError::ULCFrame");if(!i||!(s&&l))return;const y=e===x.C1InlineModal?{[Oe]:Be.ShopPayAsPaymentMethod}:null,f={shopify_domain:u,checkout_token:a,origin:e,locale:r,iframe_token:s,redirect_url:l,transaction_params:c,shop_pay_new_signup_login_variant:i,...y};o?.email&&(f.fast_login=!0);const d=Object.entries(f).map(h=>`${encodeURIComponent(h[0])}=${encodeURIComponent(h[1]||"")}`);t&&d.push(t);const m=d.join("&");return`https://${n}/pay/transactions/new/email?${m}`},[e,n,u,a,r,s,l,c,i,t,o])},gt=10;function Pt({x:e,y:n}){const t=window.devicePixelRatio||1;return{x:Math.round(e*t)/t||0,y:Math.round(n*t)/t||0}}function vt(e,n,t,o,{offset:s=0,arrowOffset:l=0}={}){let c={x:0,y:0},r={left:0,right:0},u=0;if(!n&&!t)return{offsets:c,spacing:u};if(!o){const{clientWidth:a,clientHeight:i}=document.documentElement;return c={x:a/2-n/2,y:i/2-t/2},{offsets:c,spacing:u}}switch(e){case"blockEnd":c={x:(document?.dir??"ltr")==="rtl"?o.left:o.right-n,y:o.bottom+s};break;case"inlineEnd":c={x:(document?.dir??"ltr")==="rtl"?o.left-n-s:o.right+s,y:o.top+o.height/2-l};break}return r=_t(c,n),r.right&&!r.left?(c.x+=r.right,u=-10):!r.right&&r.left&&(c.x=0,u=gt),{offsets:c,spacing:u}}function _t(e,n){const t=document.documentElement.clientWidth,o=e.x+n;let s={left:0,right:0};return o>t&&(s={...s,right:t-o}),e.x<0&&(s={...s,left:-e.x}),s}function Ct(){const[e,n]=A(null),t=M(o=>{o!==null&&n(o.getBoundingClientRect())},[]);return[e,t]}function Mt(e){const[n,t]=A(null),o=M(()=>{e!==null&&t(e.getBoundingClientRect())},[e]);return Ce(()=>(o(),window.addEventListener("resize",o),window.addEventListener("scroll",o),()=>{window.removeEventListener("resize",o),window.removeEventListener("scroll",o)}),[o]),n}const It="qdHCv",wt={Popper:It};function bt({children:e,offset:n,arrowOffset:t,contentWidth:o,contentHeight:s,placement:l="inlineEnd",activator:c,open:r}){const u=Mt(c??null),[a,i]=Ct(),{offsets:p,spacing:y}=R(()=>r?vt(l,(o||a?.width)??0,(s||a?.height)??0,u,{offset:n,arrowOffset:t}):{offsets:{x:0,y:0},spacing:0},[n,t,l,a,u,r,o,s]),{x:f,y:d}=R(()=>r?Pt({x:p.x+y+(window.scrollX||window.pageXOffset),y:p.y+(window.scrollY||window.pageYOffset)}):{x:0,y:0},[p,y,r]),m=R(()=>r?(window.devicePixelRatio||1)<2?`translate(${f}px, ${d}px)`:`translate3d(${f}px, ${d}px, 0)`:"none",[r,f,d]);return _(Fe,{children:_("div",{className:wt.Popper,style:{...a&&{transform:m,MozTransform:m,WebkitTransform:m}},ref:i,"aria-hidden":!r,children:e})})}const Lt="hgqpU",At="axmya",Tt="JHj7j",Dt="hQvGd",Nt="PMbsk",Vt="wA8HY",Ut="xnzQ4",U={Backdrop:Lt,"Backdrop-visible":"LTbS5",BackdropLinearGradient:At,Popover:Tt,Content:Dt,PopoverArrow:Nt,PopoverOpen:Vt,"Popover-placementInlineEnd":"trTaz","Popover-placementBlockEnd":"KMvI7",Bumper:Ut},xt=Ge("Popover");function Rt({children:e,activator:n,open:t,placement:o="inlineEnd",contentWidth:s,contentHeight:l,onClose:c}){const r=I(null),u=I(null),a=I(null),i=$e(void 0,xt),p=He(),y=M(()=>{n?.tagName==="BUTTON"&&(n?.setAttribute("aria-controls",i),n?.setAttribute("aria-expanded",String(t)))},[n,t,i]),f=M(k=>{c?.(k)},[c]),d=M(k=>{k.target instanceof Node&&!n?.contains(k.target)&&document.contains(k.target)&&!a.current?.contains(k.target)&&t&&f(k)},[f,n,t,a]),m=M(k=>{if(t)switch(k.key){case"Escape":case"Esc":f(),n?.focus();break}},[f,n,t]);g(()=>(document.addEventListener("click",d),()=>{document.removeEventListener("click",d)}),[d]),g(()=>(t&&document.addEventListener("keydown",m,!1),()=>{document.removeEventListener("keydown",m,!1)}),[t,m]),g(()=>{y()}),Ce(()=>{t&&a.current?.focus({preventScroll:!0})},[t]);const h=k=>{const v=a.current;if(v){const w=k?ze(v):qe(v);w?w.focus():v.focus()}},P=ye(U.Popover,U[We("Popover-placement",o)],t&&U.PopoverOpen,n&&U.PopoverArrow);return _(Me,{children:[_(bt,{activator:n,placement:o,offset:15,arrowOffset:30,open:t,contentWidth:s,contentHeight:l,children:[t&&_("button",{className:U.Bumper,ref:r,"aria-hidden":"true",onFocus:()=>h(!1)}),_("div",{className:P,id:i,ref:a,children:_("div",{className:U.Content,children:e})}),t&&_("button",{className:U.Bumper,ref:u,"aria-hidden":"true",onFocus:()=>h(!0)})]}),_("div",{className:ye(U.Backdrop,t&&U["Backdrop-visible"],t&&p&&U.BackdropLinearGradient)})]})}const Ot="B1y2m",Bt={VerificationIframe:Ot};var ie=(e=>(e.Normal="normal",e.CustomerAccount="customer_account",e.AccountsSameStore="accounts_same_store",e.AccountsCrossStore="accounts_cross_store",e))(ie||{});function Ft({email:e,skipVerifyOnLoad:n,iframeReady:t,iframeRef:o,dismissedModalKey:s,readyToDismiss:l,onReadyToDismiss:c,showPopover:r,showToggle:u,popoverActivator:a}){const i=fe(),{inMemoryPayPalParts:{accountStatus:p}}=Ie(),{guestDismissedModalKey:y}=we(),{checkoutSessionIdentifier:f}=X(),d=be(K.ShopPayVerification,{scope:Ae}),m=Le().current.token;g(()=>{if(n.current&&t){n.current=!1;return}const v=i&&le(s),w=e&&Q(e),D=p.value.status==="connected",T=i&&$t();if(!(!t||!w||v||D||T)){if(d.peek()===F.Verified){d.value=void 0;return}$(o?.current,{action:O.Create,email:e,flow:ie.Normal,disableAutoFocus:!!sessionStorage.getItem(y)})}},[e,t]);function h(){if(!f)throw new ce("ShopPayCheckoutIdentifierMissingError::GuestCheckout");i&&le(s)||e&&Q(e)&&(l||c(),m&&$(o?.current,{action:O.CheckoutQueueToken,queueToken:m}),H(ae,escape(f)),re(K.IdentifiedShopPayUser,escape(f)),H(Te,"false"),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set")),d.value=F.Pending,sessionStorage.getItem(y)?u?.(!0):(r(!0,e),u?.(!1)))}function P(){l&&(d.value=F.Dismissed,i&&H(s,"true"),a?.current?.focus(),r(!1),u?.(!0))}function k(){he(),d.value=F.Verified,J.value="none"}return{onShow:h,onHidden:P,onLoggedIn:k}}function $t(){const e=sessionStorage.getItem(Ke);if(!e)return!1;const n=Number.parseInt(e,10);return isNaN(n)?!1:Date.now()<n}const Ht=[q.FraudGuard,q.InvalidPhone,q.LimitExceeded,q.PhoneBlocked];function Wt({email:e,onSetEmail:n,skipVerifyOnLoad:t,iframeReady:o,iframeRef:s,readyToDismiss:l,onReadyToDismiss:c,showPopover:r,popoverActivator:u,origin:a,open:i}){const{checkoutSessionIdentifier:p}=X(),{openModal:y}=je(),{exchangeSessionTokenForCookie:f}=it(),d=I(null),m=I(!1),h=Ye(),P=M(()=>{s.current&&$(s.current,{action:O.Create,email:"",flow:ie.Normal})},[s]);g(()=>{s.current&&o&&a===x.C1ModalShopPaySignIn&&($(s.current,{action:O.AllowNoInitialEmail}),P(),$(s.current,{action:O.Ready}))},[o,s,a,P]),g(()=>{i&&(d.current=null)},[i]),g(()=>{m.current&&s.current&&o&&(m.current=!1,P())}),g(()=>{function S(){n&&(h.updateUserVerification({status:"none"}),n(""),u?.current?.focus()),m.current=!0}return window.addEventListener("shop_pay_verification_reset",S),()=>{window.removeEventListener("shop_pay_verification_reset",S)}},[u,r,n,s,h]),g(()=>{if(!o)return;if(t.current){t.current=!1;return}e&&Q(e)&&a!==x.C1ModalShopPaySignIn?(h.updateUserVerification({email:e,status:"loading"}),$(s?.current,{action:O.Create,email:e,flow:ie.Normal})):a!==x.C1ModalShopPaySignIn&&(P(),h.updateUserVerification({status:"none"}))},[e,o,t,s,a,h,P,r]);function k(){if(!p)throw new ce("ShopPayCheckoutIdentifierMissingError::ShopPayCheckout");a===x.C1ModalShopPay&&e&&Q(e)&&(l||c(),h.updateUserVerification({email:e,status:"found"}),r(!0,e))}function v(){if(a===x.C1ModalShopPay&&!l)return;const S=d.current;n!=null&&S!=null&&(S.status!=="found"||a===x.C1ModalShopPay||!e)&&(n(S.email??""),h.updateUserVerification(S),u?.current?.focus()),h.userVerification.status==="found"?y({type:Se.ContinueWithShopPay,email:h.userVerification.email}):u?.current?.focus(),r(!1),d.current=null}function w(S,b,N){if(!(N&&N!==h.userVerification.email)&&(S===Ne.ShopifyPayUserNotFound&&Ht.includes(b)&&(r(!1),y({type:Se.Generic})),N)){const B=b===q.InvalidEmail;h.updateUserVerification({email:N,status:B?"invalid":"new"})}}function D(S,b){S?(d.current||h.userVerification.email!==S)&&(d.current={email:S,status:b?"found":"new"}):d.current={status:"none"}}async function T(S,b){he(),J.value="none",S&&(await f({token:S,origin:a,in_checkout_profile_preview:b}),window.location.reload())}return{onShow:k,onHidden:v,onEmailChange:D,onError:w,onLoggedIn:T}}function Gt(e){const n=Qe(),t=I(e),o=t.current,s=e===t.current?void 0:`Callback hook changed from ${t.current.name} to ${e.name} between renders.`;return g(()=>{s&&n.notify(new Je(`${s} Only the original hook is called.`,"ShopPayError::OnlyOriginalHookCalled"),{severity:"warning",errorClass:"ShopPay::ShopPayVerification::useStableHook"})},[s,n]),o}const zt="shop-pay-verification-iframe",ge=320,qt=300,Kt=1e3;function jt({email:e,onSetEmail:n,open:t,popoverActivator:o,showPopover:s,showToggle:l,urlOrigin:c=x.C1Modal,updatedOrigin:r=c,onIframeLoaded:u}){const a=Xe({base:"blockEnd",medium:"inlineEnd"}),[i,p]=A(!1),[y,f]=A(qt),[d,m]=A(!1),h=Ze(),{checkoutSessionIdentifier:P}=X(),k=I(null),{alternate:v}=_e(),w=v,[D,T]=A(!1),S=et.flow.value===tt.UnauthenticatedUser,b=nt(e,st),N=`${P}-${e.replace(/[^a-zA-Z0-9]/g,"")}`,B=De(),j=I(B),{onShow:E,onHidden:C,onError:W,onEmailChange:Z,onLoggedIn:G}=Gt(S?Wt:Ft)({email:b,onSetEmail:n,skipVerifyOnLoad:j,iframeReady:i,iframeRef:k,dismissedModalKey:N,readyToDismiss:d,onReadyToDismiss:()=>{setTimeout(()=>m(!0),Kt)},showPopover:s,showToggle:l,popoverActivator:o,origin:r,open:t});ct({hostname:w,targetId:c,onReady:E,onClosed:ue,onLoggedIn:G,onHidden:C,onError:de,onResized:te,onLoaded:()=>{p(!0),u()},onEmailChange:Z}),g(()=>{$(k?.current,{action:O.OriginChanged,origin:r})},[r]),g(()=>{const V=t?O.Ready:O.Hidden;$(k?.current,{action:V}),J.value=t?"shopPayVerification":"none",k.current&&t&&k.current.focus()},[t]);const L=Et(c);if(g(()=>()=>{p(!1)},[L]),!L)return null;const ee=t?o?.current:void 0;return _(Rt,{activator:ee,open:t,onClose:C,placement:a,contentWidth:ge,contentHeight:y,children:_(ot,{active:D||!i,size:"large",children:_("iframe",{id:zt,title:h("shop_pay.verification.title","Shop Pay Quick Checkout"),ref:k,src:L,height:y,width:ge,className:Bt.VerificationIframe,allow:"publickey-credentials-get *",referrerPolicy:"origin"},L)})});function te(V){!isNaN(V)&&V&&f(V)}function ue(){T(!0)}function de(V,ne,oe){W?.(V,ne,oe),V===Ne.ShopifyPayUserNotFound&&(H(ae,"false"),re(K.IdentifiedShopPayUser,"false")),H(Te,ne===q.LimitExceeded?P||"":"false"),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set"))}}function Yt(e){const{element:n}=ut(),{loading:t}=dt();g(()=>{if(!(!n||t!==!1))return Object.entries(e).forEach(([o,s])=>{n.addEventListener(o,s)}),n?._eventListenerReadyPromiseResolve(),()=>{Object.entries(e).forEach(([o,s])=>{n?.removeEventListener(o,s)})}},[n,t,e])}function Qt(){if(!lt())return;const e="shop-pay-safari-unzoom",n=Y.getElementById(e);if(n)return n.focus();const t=Y.createElement("input");t.id=e,t.style.fontSize="16px",t.style.width="1px",t.style.height="1px",t.style.position="fixed",t.style.bottom="-1000px",t.style.right="-1000px",t.style.transform="translate(1000px, 1000px)",t.setAttribute("aria-hidden","true"),Y.body.appendChild(t),t.focus({preventScroll:!0})}const Jt=100;function Xt({emailInputSelector:e}){const[n,t]=A(),[o,s]=A();return g(()=>{function c(r){this.type==="password"?s(r.timeStamp):t(r.timeStamp)}if(e){const r=Y.querySelector(e);if(r){r.addEventListener("input",c);const u=r.form?.querySelector('input[type="password"]');return u&&u instanceof HTMLInputElement&&u.addEventListener("input",c),()=>{r.removeEventListener("input",c),u&&u.removeEventListener("input",c)}}}},[e]),{isFilledWithPasswordManager:R(()=>n===void 0||o===void 0?!1:Math.abs(n-o)<Jt,[n,o])}}function Zt({autoOpen:e,email:n,emailInputSelector:t,hideChange:o,iframeRef:s,shouldListen:l=!0}){const{autoOpened:c,loaded:r,modalVisible:u,sessionDetected:a}=pe(),{leaveBreadcrumb:i,notify:p}=Ve(),{trackUserAction:y}=me(),{isFilledWithPasswordManager:f}=Xt({emailInputSelector:t}),d=I(null),[m,h]=A(),[P,k]=A(),[v,w]=A(),D=I(null),T=I(""),S=R(()=>new Set,[]),b=()=>T.current,N=M(async(E,C="",W="")=>{const Z=ft(E);if(f&&!S.has("PASSWORD_MANAGER_AUTOFILL_DETECTED")&&(S.add("PASSWORD_MANAGER_AUTOFILL_DETECTED"),y({userAction:"PASSWORD_MANAGER_AUTOFILL_DETECTED"})),Z&&!S.has("EMAIL_ENTERED")&&(S.add("EMAIL_ENTERED"),y({userAction:"EMAIL_ENTERED"})),i("email entered",{},"state"),!s.current||u||r&&a&&e&&!c)return;const G=Z?E:"";d.current&&!d.current?.signal.aborted&&d.current.abort(),d.current=new AbortController;try{const{open:L,postMessage:ee,waitForMessage:te}=s.current;T.current=G,ee({firstName:C,lastName:W,type:"namesubmitted"}),ee({email:G,hideChange:o===void 0?G.length>0:o,type:"emailsubmitted"}),i("email submitted",{email:G?"redacted":""},"state");const ue=te("shop_user_matched",d.current.signal),de=new Promise((V,ne)=>{const oe=async()=>{try{const se=await te("error",d.current.signal);se.type==="error"&&se.code==="captcha_challenge"?V(void 0):oe()}catch(se){ne(se)}};oe()});await Promise.race([ue,de]),L("event_shop_user_matched"),D?.current?.blur(),Qt(),d.current.abort(),h(void 0)}catch(L){if(L instanceof ht&&L.name==="AbortSignalReceivedError")return;L instanceof Error&&p(new Error(`Error updating user info: ${L.name} - ${L.message}`))}},[e,c,o,s,f,i,r,u,p,a,y,S]),B=pt((E,C,W)=>{N(E,C,W)},200);g(()=>{m!==void 0&&r&&B(m,P,v)},[B,m,r,P,v]),g(()=>{if(!t)return;const E=Y.querySelector(t);if(!E)return;D.current=E;const C=()=>{E&&h(E.value)};if(E?.value&&C(),!l){E?.removeEventListener("input",C);return}return E?.addEventListener("input",C),()=>{E?.removeEventListener("input",C)}},[t,l]),g(()=>{n!==void 0&&h(n)},[n]);const j=(E="",C="")=>{k(E),w(C)};return{getSubmittedEmail:b,updateEmailToPost:E=>h(E||""),updateNamesToPost:(E,C)=>j(E,C)}}function en({iframeRef:e}){const{loaded:n}=pe();async function t(o){if(!e.current)return;const{postMessage:s,waitForMessage:l}=e.current;n||await l("loaded"),s(o)}return{postMessageAfterLoad:t}}function tn(){const{analyticsData:e,produceMonorailEvent:n}=me();return{trackShopPayModalStateChange:M(({currentState:o,zoom:s})=>{const{analyticsTraceId:l,checkoutToken:c,checkoutVersion:r,shopPermanentDomain:u}=e,a={previousState:"",currentState:o,clientTimestampMs:new Date().getTime(),analyticsTraceId:l,checkoutToken:c||"",checkoutVersion:r||"",shopifyDomain:u||"",zoom:s};n({event:{payload:a,schemaId:"shopify_pay_modal_state_change/1.3"}})},[e,n])}}function nn(e){const{checkoutToken:n,checkoutVersion:t,shopPermanentDomain:o}=e;return{checkoutVersion:t,checkoutToken:n,flow:"checkout_modal",shopPermanentDomain:o}}const on=({anchorTo:e,email:n,queueToken:t,...o})=>{const{modalVisible:s}=pe(),l=I(null);Zt({email:n,iframeRef:l});const{postMessageAfterLoad:c}=en({iframeRef:l}),{trackUserAction:r}=me(),{leaveBreadcrumb:u}=Ve(),a=R(()=>({open:async()=>{s||(l.current?.open("user_button_clicked"),r({userAction:"OPEN_CALLED"}),u("open called",{},"state"))}}),[s,r,u]);Yt(a);const{trackShopPayModalStateChange:i}=tn(),p=M(()=>{i({currentState:"loaded",zoom:`${Ee.visualViewport?.scale}`})},[i]),y=M(d=>{i({currentState:d?"shown":"hidden",zoom:`${Ee.visualViewport?.scale}`})},[i]);g(()=>{t&&c({type:"checkoutqueuetokensubmitted",checkoutQueueToken:t})},[c,t]);const{authorizeUrl:f}=St({analyticsContext:"loginWithShopCheckoutModal",avoidSdkSession:!0,clientId:"",disableSignUp:!0,proxy:!0,redirectType:"iframe",responseType:"code",...o});return _(kt,{anchorTo:e,keepModalOpen:!0,onLoaded:p,onModalVisibleChange:y,proxy:!0,ref:l,src:f,variant:"checkoutModal"})},sn=()=>mt(({element:e,...n})=>_(yt,{element:e,monorailProps:nn(n),featureName:"ShopCheckoutModal",children:_(on,{...n})}),{methods:["open"],name:"shop-checkout-modal",props:{anchorTo:"string",checkoutRedirectUrl:"string",checkoutToken:"string",checkoutVersion:"string",email:"string",queueToken:"string",shopPermanentDomain:"string",transactionParams:"string"},shadow:"open"}),z=({shopCheckoutModal:e,eventName:n,eventListener:t})=>{g(()=>(e?.addEventListener(n,t),()=>e?.removeEventListener(n,t)),[t,n,e])};function rn({email:e,open:n,popoverActivator:t,showPopover:o,showToggle:s,onIframeLoaded:l}){const c=t?.current,r=I(null),[u,a]=A(!1),i=I(!1),{redirect_url:p,transaction_params:y}=Pe(),{myshopifyDomain:f}=ve(),d=fe(),{inMemoryPayPalParts:{accountStatus:m}}=Ie(),{guestDismissedModalKey:h}=we(),{checkoutSessionIdentifier:P}=X(),k=Le().current.token;g(()=>{customElements.get("shop-checkout-modal")||sn()},[]);const v=be(K.ShopPayVerification,{scope:Ae}),w=`${P}-${e.replace(/[^a-zA-Z0-9]/g,"")}`,D=De(),T=I(D);g(()=>{if(T.current){T.current=!1,a(!1);return}const E=sessionStorage.getItem(h),C=d&&le(w),W=m.peek().status==="connected";if(E||C||W){a(!1);return}if(v.peek()===F.Verified){v.value=void 0,a(!1);return}a(!0)},[e]);const S=M(()=>{he(),v.value=F.Verified,J.value="none"},[v]);z({shopCheckoutModal:r.current,eventName:"completed",eventListener:S});const b=M(()=>{if(!P)throw new ce("ShopPayCheckoutIdentifierMissingError::ShopJSVerification");H(ae,escape(P)),re(K.IdentifiedShopPayUser,escape(P)),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set")),v.value=F.Pending,o?.(!0,e),s?.(!1)},[P,e,v,o,s]);z({shopCheckoutModal:r.current,eventName:"modalopened",eventListener:b});const N=M(()=>{v.value=F.Dismissed,d&&H(w,"true"),o?.(!1),s?.(i.current)},[d,w,v,o,s]);z({shopCheckoutModal:r.current,eventName:"modalclosed",eventListener:N});const B=M(()=>{i.current=!0},[]);z({shopCheckoutModal:r.current,eventName:"shopusermatched",eventListener:B});const j=M(E=>{i.current=!1,H(ae,"false"),re(K.IdentifiedShopPayUser,"false"),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set"))},[]);return z({shopCheckoutModal:r.current,eventName:"shopusernotmatched",eventListener:j}),z({shopCheckoutModal:r.current,eventName:"loaded",eventListener:l}),g(()=>{const E=r.current;J.value=n?"shopPayVerification":"none",c&&n&&(E?.open(),c.blur())},[c,e,n]),p?_("shop-checkout-modal",{"anchor-to":c?.id?`#${c.id}`:"","checkout-redirect-url":p,"checkout-token":P,"checkout-version":"checkout_one",email:n||u?e:"","queue-token":k||"",ref:r,"shop-permanent-domain":f,"transaction-params":y}):null}const an=e=>_(Me,{children:_(rn,{...e})}),ln=({email:e,onSetEmail:n,open:t,popoverActivator:o,showPopover:s,showToggle:l,urlOrigin:c=x.C1Modal,updatedOrigin:r=x.C1Modal})=>{const u=rt(),a=at(),i=R(()=>ke(),[]),p=R(()=>ke(),[]),y=I(!0),f=R(()=>{if(u!==void 0)return{isC1:!0,shopJsVerification:!u}},[u]);g(()=>{Q(e)&&(i.mark("start"),y.current=!0)},[i,e]),g(()=>{if(t&&y.current&&i.marks.start&&f){i.mark("open"),y.current=!1;const m=Math.round(i.marks.open-i.marks.start);a.histogram({name:"shop_pay_verification_time_to_interactive",value:m,attributes:f});const h=Math.round(i.marks.open-Math.max(i.marks.start,i.marks.loaded||0));a.histogram({name:"shop_pay_verification_time_to_interactive_after_load",value:h,attributes:f})}},[t,a,i,f]),g(()=>{p.mark("start")},[p]);const d=M(()=>{if(p.marks.start){p.mark("loaded"),i.mark("loaded");const m=Math.round(p.marks.loaded-p.marks.start);a.histogram({name:"shop_pay_verification_iframe_ready_duration",value:m,attributes:f})}},[p,i,a,f]);return u?_(jt,{popoverActivator:o,email:e,onSetEmail:n,open:t,showPopover:s,showToggle:l,urlOrigin:c,updatedOrigin:r,onIframeLoaded:d}):_(an,{popoverActivator:o,email:e,open:t,showPopover:s,showToggle:l,onIframeLoaded:d})};export{ln as default};
